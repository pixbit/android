package com.empsi.inepabor;

import java.io.InputStream;
import java.util.List;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.InputSource;
import org.xml.sax.XMLReader;

import android.app.Activity;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Bundle;
import android.util.Log;
import android.widget.Toast;

public class MainActivity extends Activity {

	public static final String TAG = MainActivity.class.getSimpleName();
	public List<ParsedRow> entries;
	public List<ParsedRow> currentEntries;
	public List<ParsedRow> previousEntries;
	public List<String> titleList;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
        final boolean customTitleSupported = requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);

        if ( customTitleSupported ) {
            getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.mytitle);
        }

        final TextView myTitleText = (TextView) findViewById(R.id.myTitle);
        if ( myTitleText != null ) {
            myTitleText.setText("========= NEW TITLE ==========");
            myTitleText.setBackgroundColor(Color.GREEN);
        }
        
        try {
            /* Get a SAXParser from the SAXPArserFactory. */
            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser sp = spf.newSAXParser();

            /* Get the XMLReader of the SAXParser we created. */
            XMLReader xr = sp.getXMLReader();
            /* Create a new ContentHandler and apply it to the XML-Reader*/
            PlistHandler myHandler = new PlistHandler();
            xr.setContentHandler(myHandler);
            
            /* Parse the xml-data from our file. */
            Resources res = getResources();
            InputStream is = res.openRawResource(R.raw.data);
            xr.parse(new InputSource(is));
            /* Parsing has finished. */

            /* Our PlistHandler now provides the parsed data to us. */
        		this.entries = myHandler.getListOfRows();
//        		Log.d(TAG, "Number of entries on this list: " + Integer.toString(entries.size()));
        		
        		this.currentEntries = this.entries;
            
            /* Set the result to be displayed in our GUI. */
//          Toast.makeText(this, parsedExampleDataSet.toString(), Toast.LENGTH_SHORT).show();
           
     	} catch (Exception e) {
        		/* Display any Error to the GUI. */
        		Log.e(TAG, "XMLQueryError", e);
        	}
        
        Intent receiveIntent = getIntent();
        String content = receiveIntent.getData().toString();
//        WebView engine = (WebView) findViewById(R.id.web_engine);
//        engine.loadUrl(content);
        
        Bundle extras = receiveIntent.getExtras();
        if (extras == null) {
            return;
        }
        // Get data via the key
        String view = extras.getString("view");
        if (view != null) {
          // Do something with the data
        }
        
        Toast.makeText(this, view, Toast.LENGTH_SHORT).show();
        
        
//        WebView engine = (WebView) findViewById(R.id.web_engine);
//        engine.getSettings().setJavaScriptEnabled(true);
//        engine.loadData(data, "text/html", "UTF-8");
//        engine.loadUrl("file:///android_asset/handbook.htm");
        
        
    }
//
//    @Override
//    public boolean onCreateOptionsMenu(Menu menu) {
//        // Inflate the menu; this adds items to the action bar if it is present.
//        getMenuInflater().inflate(R.menu.activity_main_list, menu);
//        return true;
//    }
    
}
